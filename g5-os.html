<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGENTICUM G5 | THE PERFECT TWIN</title>
    <meta name="description" content="Industrial Autonomous Marketing Operating System - 52 Specialized AI Nodes">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/g5-os.css">
    <style>
        /* DEMO SPOTLIGHT MODE */
        .dimmed-node {
            opacity: 0.2 !important;
            filter: grayscale(100%) !important;
            transition: all 0.5s ease;
        }
        
        .active-demo-node {
            opacity: 1 !important;
            filter: none !important;
            box-shadow: 0 0 20px var(--accent-primary), inset 0 0 10px var(--accent-primary) !important;
            border-color: var(--accent-primary) !important;
            z-index: 100;
            transform: scale(1.05);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .tree-item.active-demo-node {
            background: rgba(74, 222, 128, 0.1);
            border-left: 2px solid var(--accent-primary);
        }
/* 3D TOGGLE BUTTON */
.featured-btn {
    background: rgba(0, 243, 255, 0.1);
    border: 1px solid var(--accent-teal);
    color: var(--accent-teal);
    padding: 0.4rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-family: var(--font-mono);
    font-weight: bold;
    position: relative;
    overflow: hidden;
    transition: all 0.3s;
    box-shadow: 0 0 10px rgba(0, 243, 255, 0.1);
}

.featured-btn:hover {
    background: var(--accent-teal);
    color: #000;
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
}

.btn-glow {
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 60%);
    opacity: 0;
    transform: scale(0.5);
    transition: opacity 0.3s;
    pointer-events: none;
}

.featured-btn:active .btn-glow {
    opacity: 0.3;
    animation: ripple 0.4s linear;
}


        /* HOLOGRAPHIC GLITCH FX (PHASE 6) */
        @keyframes glitch-anim-1 {
            0% { clip: rect(20px, 9999px, 81px, 0); transform: translate(-2px) skew(1deg); }
            20% { clip: rect(61px, 9999px, 4px, 0); transform: translate(1px) skew(0deg); }
            40% { clip: rect(56px, 9999px, 78px, 0); transform: translate(3px) skew(-1deg); }
            60% { clip: rect(65px, 9999px, 49px, 0); transform: translate(-1px) skew(2deg); }
            80% { clip: rect(3px, 9999px, 20px, 0); transform: translate(2px) skew(0deg); }
            100% { clip: rect(6px, 9999px, 67px, 0); transform: translate(1px) skew(-0.5deg); }
        }
        @keyframes glitch-anim-2 {
            0% { clip: rect(10px, 9999px, 91px, 0); transform: translate(1px) skew(-0.5deg); }
            20% { clip: rect(5px, 9999px, 34px, 0); transform: translate(-2px) skew(1deg); }
            40% { clip: rect(51px, 9999px, 28px, 0); transform: translate(2px) skew(-1deg); }
            60% { clip: rect(15px, 9999px, 12px, 0); transform: translate(-1px) skew(2deg); }
            80% { clip: rect(33px, 9999px, 74px, 0); transform: translate(1px) skew(0deg); }
            100% { clip: rect(2px, 9999px, 47px, 0); transform: translate(-2px) skew(0.5deg); }
        }
        .glitch-active {
            position: relative;
        }
        .glitch-active::before,
        .glitch-active::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary, #000);
            pointer-events: none;
        }
        .glitch-active::before {
            left: 2px;
            text-shadow: -1px 0 #ff00c1;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim-1 2s infinite linear alternate-reverse;
        }
        .glitch-active::after {
            left: -2px;
            text-shadow: -1px 0 #00fff9;
            clip: rect(44px, 450px, 56px, 0);
            animation: glitch-anim-2 2s infinite linear alternate-reverse;
        }

        /* 3D VIEW STATE */
        .agents-view-3d .agents-grid {
            opacity: 0;
            pointer-events: none;
        }
        
        .agents-view-3d #dashboard-neural-container {
            opacity: 1 !important;
            z-index: 10 !important;
            pointer-events: auto !important;
        }
        
        .agents-view-3d #neuralCanvas {
            opacity: 0;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="g5-os-body">
    <!-- BOOT OVERLAY V2 (CINEMATIC BIOS) -->
    <div id="boot-overlay" style="position:fixed; inset:0; background:#000; z-index:9999; display:flex; flex-direction:column; align-items:center; justify-content:center; overflow:hidden; backdrop-filter: blur(20px);">
        <!-- Elite Shimmer Canvas -->
        <canvas id="bootMesh" style="position:absolute; inset:0; opacity:0.3; pointer-events: none;"></canvas>
        
        <!-- CRT Scanline & Grain -->
        <div class="crt-overlay" style="position:absolute; inset:0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.15) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03)); background-size: 100% 3px, 3px 100%; pointer-events: none; z-index: 10;"></div>
        
        <!-- CRT Scanline -->
        <div style="position:absolute; inset:0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); background-size: 100% 2px, 3px 100%; pointer-events: none;"></div>
        
        <div id="boot-terminal" style="font-family:'JetBrains Mono', monospace; color:#4ade80; font-size:12px; width:600px; max-width:90%; margin-bottom:2rem; height:200px; overflow:hidden; display:flex; flex-direction:column; justify-content:flex-end; text-shadow: 0 0 5px #4ade80;">
            <div>> BIOS CHECK... OK</div>
            <div>> MEMORY TEST... 64GB OK</div>
            <div>> NEURAL MESH... DETECTED</div>
            <div>> LOADING KERNEL G5...</div>
        </div>

        <div style="position:relative;">
            <div id="boot-logo-container" style="display:flex; flex-direction:column; align-items:center; opacity:0.5; transition:all 1s;">
                <h1 class="glitch-active" data-text="AGENTICUM G5" style="font-family:'Rajdhani', sans-serif; font-size: 4rem; letter-spacing: 10px; margin: 0; color:#fff;">AGENTICUM G5</h1>
                <p style="font-family:'JetBrains Mono'; color:#60a5fa; letter-spacing: 4px; font-size: 1rem;">AUTONOMOUS OPERATING SYSTEM</p>
            </div>
        </div>

        <button id="boot-btn" onclick="G5OS.unlockSystem()" class="featured-btn hidden" style="margin-top:3rem; padding: 1.25rem 5rem; font-size: 1.1rem; letter-spacing: 5px;">
            <span style="position:relative; z-index:2;">INITIALIZE SYSTEM</span>
            <div class="btn-glow"></div>
        </button>
        
        <style>
            .featured-btn.hidden { display: none; }
            #boot-btn { transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1); }
            #boot-btn:hover { letter-spacing: 8px; }
        </style>
    </div>

    <!-- GLOBAL NEURAL BACKGROUND -->
    <div id="global-scenery" style="position:fixed; inset:0; z-index:-1; background: var(--bg-base); overflow:hidden;">
        <canvas id="neuralCanvas"></canvas>
        <div class="ambient-glow g1"></div>
        <div class="ambient-glow g2"></div>
    </div>

    <!-- BOOT SCRIPT MOVED TO CORE.JS -->




    <!-- ============================================
         TOP BAR - SYSTEM HEADER
         ============================================ -->
    <header class="os-header">
        <div class="os-header-left">
            <a href="index.html" class="os-logo" style="text-decoration: none; cursor: pointer;">
                <span class="logo-icon">‚óÜ</span>
                <span class="logo-text">AGENTICUM</span>
                <span class="logo-version">G5</span>
            </a>
            <nav class="os-tabs">
                <button class="os-tab active" data-view="workspace">
                    <span class="tab-icon">‚¨°</span>
                    <span>Workspace</span>
                </button>
                <button class="os-tab" data-view="agents">
                    <span class="tab-icon">üß†</span>
                    <span>Agents</span>
                </button>
                <button class="os-tab" data-view="workflows">
                    <span class="tab-icon">‚ö°</span>
                    <span>Workflows</span>
                </button>
                <button class="os-tab" data-view="playground">
                    <span class="tab-icon">üß™</span>
                    <span>Playground</span>
                </button>
                <button class="os-tab" data-view="extensions">
                    <span class="tab-icon">üß©</span>
                    <span>Extensions</span>
                </button>
                <button class="os-tab" data-view="assets">
                    <span class="tab-icon">üì¶</span>
                    <span>Assets</span>
                </button>
                <button class="os-tab" data-view="logs">
                    <span class="tab-icon">üìã</span>
                    <span>Audit</span>
                </button>
            </nav>
        </div>
        <div class="os-header-center">
            <div class="os-status">
                <span class="status-dot online"></span>
                <span class="status-text">52 NODES OPERATIONAL</span>
            </div>
            <div class="jury-indicator pulse-text" style="font-size: 8px; color: var(--accent-secondary); margin-top: 4px; letter-spacing: 1.5px; opacity:0.8;">
                RECALL: SOVEREIGN_DB | <span style="color:#60a5fa;">MODE: JURY_CORE_UPLINK</span>
            </div>
        </div>
        <div class="os-header-right">
            <div class="os-metrics">
                <div class="metric">
                    <span class="metric-value" id="tokenCount">1.7M</span>
                    <span class="metric-label">TOKENS</span>
                </div>
                <div class="metric">
                    <span class="metric-value" id="latencyDisplay">~87ms</span>
                    <span class="metric-label">LATENCY</span>
                </div>
            </div>
            <button class="os-btn-icon" id="settingsBtn" title="Settings">‚öôÔ∏è</button>
            <div class="os-user">
                <span class="user-avatar">YY</span>
                <div style="display:flex; flex-direction:column; align-items:flex-end; line-height:1.1;">
                    <span class="user-name" style="font-size:11px;">OPERATOR_YILDIRIM</span>
                    <span style="font-size:9px; color:var(--accent-primary);">ARCHITECT // G5_RC</span>
                </div>
            </div>
        </div>
    </header>

    <!-- ============================================
         MAIN OS LAYOUT
         ============================================ -->
    <div class="os-container">
        
        <!-- LEFT PANEL: EXPLORER -->
        <aside class="os-panel os-panel-left" id="leftPanel">
            <div class="panel-resize-handle" data-panel="left"></div>
            
            <!-- MODULE SELECTOR -->
            <div class="panel-section">
                <div class="section-header">
                    <span class="section-icon">üß†</span>
                    <span>NEURAL CLUSTERS</span>
                    <button class="section-action" title="Add Node">+</button>
                </div>
                <div class="module-tree" id="moduleTree">
                    <!-- APEX NODE -->
                    <div class="tree-item folder open" data-cluster="apex">
                        <span class="tree-toggle">‚ñº</span>
                        <span class="tree-icon">üëë</span>
                        <span class="tree-label">APEX_NODE (Brain)</span>
                    </div>
                    <div class="tree-children">
                        <div class="tree-item file active" data-node="SN-00">
                            <span class="tree-icon node-icon apex">‚óÜ</span>
                            <span class="tree-label">SN-00 Orchestrator</span>
                            <span class="tree-status online"></span>
                        </div>
                    </div>

                    <!-- STRATEGY CLUSTER -->
                    <div class="tree-item folder open" data-cluster="strategy">
                        <span class="tree-toggle">‚ñº</span>
                        <span class="tree-icon">üìÇ</span>
                        <span class="tree-label">STRATEGY_CLUSTER</span>
                        <span class="tree-count">3</span>
                    </div>
                    <div class="tree-children">
                        <div class="tree-item file" data-node="SP-01">
                            <span class="tree-icon node-icon sp">‚óÜ</span>
                            <span class="tree-label">SP-01 Campaign Strategist</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="SP-99">
                            <span class="tree-icon node-icon sp">‚óÜ</span>
                            <span class="tree-label">SP-99 Hegemony Matrix</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="SP-77">
                            <span class="tree-icon node-icon sp">‚óÜ</span>
                            <span class="tree-label">SP-77 Logic Patcher</span>
                            <span class="tree-status online"></span>
                        </div>
                    </div>
                    
                    <!-- RESEARCH CLUSTER -->
                    <div class="tree-item folder" data-cluster="research">
                        <span class="tree-toggle">‚ñ∂</span>
                        <span class="tree-icon">üìÇ</span>
                        <span class="tree-label">RESEARCH_CLUSTER</span>
                        <span class="tree-count">8</span>
                    </div>
                    <div class="tree-children" style="display: none;">
                        <div class="tree-item file" data-node="RA-01">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-01 Authority Auditor</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="RA-06">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-06 Trend Forecaster</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="RA-52">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-52 Red Team</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="RA-11">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-11 Market Scanner</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="RA-22">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-22 Sentiment Analyst</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="RA-33">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-33 Patent Scout</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="RA-44">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-44 Academic Miner</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="RA-55">
                            <span class="tree-icon node-icon ra">‚óÜ</span>
                            <span class="tree-label">RA-55 Social Listener</span>
                            <span class="tree-status online"></span>
                        </div>
                    </div>
                    
                    <!-- CONTENT CLUSTER -->
                    <div class="tree-item folder" data-cluster="content">
                        <span class="tree-toggle">‚ñ∂</span>
                        <span class="tree-icon">üìÇ</span>
                        <span class="tree-label">CONTENT_CLUSTER</span>
                        <span class="tree-count">32</span>
                    </div>
                    <div class="tree-children" style="display: none;">
                        <div class="tree-item file" data-node="CC-01">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-01 Copy Chief</span>
                            <span class="tree-status processing"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-06">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-06 Video Director</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-08">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-08 Flash Voice</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-13">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-13 Music Composer</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-02">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-02 Blog Writer</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-03">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-03 Social Media</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-04">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-04 Email Crafter</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-05">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-05 Script Writer</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-07">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-07 Image Gen (Imagen 3)</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="CC-09">
                            <span class="tree-icon node-icon cc">‚óÜ</span>
                            <span class="tree-label">CC-09 Podcast Producer</span>
                            <span class="tree-status online"></span>
                        </div>
                    </div>
                    
                    <!-- GOVERNANCE CLUSTER -->
                    <div class="tree-item folder" data-cluster="governance">
                        <span class="tree-toggle">‚ñ∂</span>
                        <span class="tree-icon">üìÇ</span>
                        <span class="tree-label">GOVERNANCE_CLUSTER</span>
                        <span class="tree-count">4</span>
                    </div>
                    <div class="tree-children" style="display: none;">
                        <div class="tree-item file" data-node="MI-01">
                            <span class="tree-icon node-icon mi">‚óÜ</span>
                            <span class="tree-label">MI-01 Compliance Officer</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="MI-07">
                            <span class="tree-icon node-icon mi">‚óÜ</span>
                            <span class="tree-label">MI-07 Ethics Auditor</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="MI-03">
                            <span class="tree-icon node-icon mi">‚óÜ</span>
                            <span class="tree-label">MI-03 Brand Guardian</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="MI-04">
                            <span class="tree-icon node-icon mi">‚óÜ</span>
                            <span class="tree-label">MI-04 Legal Scanner</span>
                            <span class="tree-status online"></span>
                        </div>
                    </div>
                    
                    <!-- INTELLIGENCE CLUSTER -->
                    <div class="tree-item folder" data-cluster="intelligence">
                        <span class="tree-toggle">‚ñ∂</span>
                        <span class="tree-icon">üìÇ</span>
                        <span class="tree-label">INTELLIGENCE_CLUSTER</span>
                        <span class="tree-count">4</span>
                    </div>
                    <div class="tree-children" style="display: none;">
                        <div class="tree-item file" data-node="DT-02">
                            <span class="tree-icon node-icon dt">‚óÜ</span>
                            <span class="tree-label">DT-02 Pricing Algorithm</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="DT-04">
                            <span class="tree-icon node-icon dt">‚óÜ</span>
                            <span class="tree-label">DT-04 Analytics Core</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="DT-05">
                            <span class="tree-icon node-icon dt">‚óÜ</span>
                            <span class="tree-label">DT-05 A/B Optimizer</span>
                            <span class="tree-status online"></span>
                        </div>
                        <div class="tree-item file" data-node="DT-06">
                            <span class="tree-icon node-icon dt">‚óÜ</span>
                            <span class="tree-label">DT-06 Conversion Predictor</span>
                            <span class="tree-status online"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WORKFLOWS -->
            <div class="panel-section">
                <div class="section-header">
                    <span class="section-icon">‚ö°</span>
                    <span>WORKFLOWS</span>
                </div>
                <div class="workflow-list">
                    <div class="workflow-item" data-workflow="5min-agency">
                        <span class="wf-icon">‚ö°</span>
                        <span class="wf-name">5-Minute Agency</span>
                    </div>
                    <div class="workflow-item" data-workflow="senate">
                        <span class="wf-icon">‚öñÔ∏è</span>
                        <span class="wf-name">Algorithmic Senate</span>
                    </div>
                    <div class="workflow-item" data-workflow="morphosis">
                        <span class="wf-icon">üîÑ</span>
                        <span class="wf-name">Narrative Morphosis</span>
                    </div>
                    <div class="workflow-item" data-workflow="jit-reality">
                        <span class="wf-icon">üîÆ</span>
                        <span class="wf-name">Just-in-Time Reality</span>
                    </div>
                    <div class="workflow-item active" data-workflow="autopoiesis">
                        <span class="wf-icon">üîß</span>
                        <span class="wf-name">Autopoiesis</span>
                        <span class="wf-status active">ACTIVE</span>
                    </div>
                </div>
            </div>

            <!-- RECENT ASSETS -->
            <div class="panel-section">
                <div class="section-header">
                    <span class="section-icon">üì¶</span>
                    <span>RECENT ASSETS</span>
                </div>
                <div class="asset-list" id="recentAssets">
                    <div class="asset-mini" data-type="text">
                        <span class="asset-icon">üìÑ</span>
                        <span class="asset-name">MANIFESTO_V5.md</span>
                    </div>
                    <div class="asset-mini" data-type="video">
                        <span class="asset-icon">üé¨</span>
                        <span class="asset-name">VEO_CINEMATIC.mp4</span>
                    </div>
                    <div class="asset-mini" data-type="image">
                        <span class="asset-icon">üñºÔ∏è</span>
                        <span class="asset-name">CAMPAIGN_HERO.png</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- CENTER: MAIN WORKSPACE -->
        <main class="os-main" id="mainWorkspace">
            
            <!-- WORKSPACE TABS -->
            <div class="workspace-tabs">
                <div class="workspace-tab active" data-tab="chat">
                    <span class="tab-icon">üí¨</span>
                    <span>Chat</span>
                    <button class="tab-close">√ó</button>
                </div>
                <div class="workspace-tab" data-tab="editor">
                    <span class="tab-icon">üìù</span>
                    <span>Editor</span>
                    <button class="tab-close">√ó</button>
                </div>
                <div class="workspace-tab" data-tab="preview">
                    <span class="tab-icon">üëÅÔ∏è</span>
                    <span>Preview</span>
                    <button class="tab-close">√ó</button>
                </div>
                <button class="tab-add" title="New Tab">+</button>
            </div>

            <!-- CHAT VIEW (Active by default) -->
            <div class="workspace-content" id="chatView">
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <!-- SYSTEM WELCOME -->
                        <div class="chat-message system">
                            <div class="msg-header">
                                <span class="msg-icon">‚óÜ</span>
                                <span class="msg-sender">AGENTICUM G5</span>
                                <span class="msg-time">SYSTEM</span>
                            </div>
                            <div class="msg-content">
                                <p>Welcome to <strong>AGENTICUM G5</strong> - The Industrial Autonomous Marketing OS.</p>
                                <p>52 specialized AI nodes are online and ready to execute your commands.</p>
                                <div class="msg-capabilities">
                                    <span class="cap-tag">Strategy</span>
                                    <span class="cap-tag">Content</span>
                                    <span class="cap-tag">Research</span>
                                    <span class="cap-tag">Governance</span>
                                    <span class="cap-tag">Intelligence</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- CHAT INPUT -->
                    <div class="chat-input-container">
                        <div class="chat-input-wrapper">
                            <button class="input-action" id="attachBtn" title="Attach File">üìé</button>
                            <textarea class="chat-input" id="chatInput" placeholder="Enter your command, briefing, or question..." rows="1"></textarea>
                            <button class="input-action" id="voiceBtn" title="Voice Input">üéôÔ∏è</button>
                            <button class="chat-send" id="sendBtn" title="Send (Enter)">
                                <span>‚Üí</span>
                            </button>
                        </div>
                        <div class="chat-suggestions">
                            <button class="suggestion" data-cmd="Design a viral campaign for SaaS launch">üöÄ Campaign Design</button>
                            <button class="suggestion" data-cmd="Analyze competitor vulnerabilities">üîç Competitor Scan</button>
                            <button class="suggestion" data-cmd="Generate 50 ad copy variations">‚úçÔ∏è Batch Copy</button>
                            <button class="suggestion" data-cmd="Run compliance check on strategy">‚öñÔ∏è Compliance</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- EDITOR VIEW (Hidden) -->
            <div class="workspace-content hidden" id="editorView">
                <div class="editor-container">
                    <div class="editor-header">
                        <span class="editor-filename">MANIFESTO_V5.md</span>
                        <div class="editor-actions">
                            <button class="editor-btn">üíæ Save</button>
                            <button class="editor-btn">üìã Copy</button>
                        </div>
                    </div>
                    <textarea class="editor-content" id="editorContent" placeholder="Start writing..."></textarea>
                </div>
            </div>

            <!-- PREVIEW VIEW (Hidden) -->
            <div class="workspace-content hidden" id="previewView">
                <div class="preview-container">
                    <div class="preview-header">
                        <div class="preview-tabs">
                            <button class="preview-tab active" data-type="all">All</button>
                            <button class="preview-tab" data-type="text">üìÑ Text</button>
                            <button class="preview-tab" data-type="image">üñºÔ∏è Images</button>
                            <button class="preview-tab" data-type="video">üé¨ Video</button>
                            <button class="preview-tab" data-type="audio">üéµ Audio</button>
                        </div>
                        <div class="preview-actions">
                            <button class="btn btn-small" id="uploadAssetBtn">üì§ Upload</button>
                            <button class="btn btn-small" id="generateAssetBtn">‚ú® Generate</button>
                        </div>
                    </div>
                    
                    <!-- ASSETS GRID -->
                    <div class="assets-grid" id="assetsGrid">
                        <div class="asset-card" data-type="text" data-id="asset-1">
                            <div class="asset-thumbnail text">üìÑ</div>
                            <div class="asset-info">
                                <span class="asset-title">MANIFESTO_V5.md</span>
                                <span class="asset-meta">2.4 KB ‚Ä¢ Today</span>
                            </div>
                            <div class="asset-actions">
                                <button class="asset-action" title="Preview">üëÅÔ∏è</button>
                                <button class="asset-action" title="Download">‚¨áÔ∏è</button>
                                <button class="asset-action" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                        
                        <div class="asset-card" data-type="video" data-id="asset-2">
                            <div class="asset-thumbnail video">
                                <span class="play-icon">‚ñ∂</span>
                            </div>
                            <div class="asset-info">
                                <span class="asset-title">VEO_CINEMATIC.mp4</span>
                                <span class="asset-meta">45 MB ‚Ä¢ Yesterday</span>
                            </div>
                            <div class="asset-actions">
                                <button class="asset-action" title="Preview">üëÅÔ∏è</button>
                                <button class="asset-action" title="Download">‚¨áÔ∏è</button>
                                <button class="asset-action" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                        
                        <div class="asset-card" data-type="image" data-id="asset-3">
                            <div class="asset-thumbnail image">üñºÔ∏è</div>
                            <div class="asset-info">
                                <span class="asset-title">CAMPAIGN_HERO.png</span>
                                <span class="asset-meta">1.2 MB ‚Ä¢ Yesterday</span>
                            </div>
                            <div class="asset-actions">
                                <button class="asset-action" title="Preview">üëÅÔ∏è</button>
                                <button class="asset-action" title="Download">‚¨áÔ∏è</button>
                                <button class="asset-action" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                        
                        <div class="asset-card" data-type="audio" data-id="asset-4">
                            <div class="asset-thumbnail audio">üéµ</div>
                            <div class="asset-info">
                                <span class="asset-title">SONIC_LOGO.wav</span>
                                <span class="asset-meta">890 KB ‚Ä¢ 2 days ago</span>
                            </div>
                            <div class="asset-actions">
                                <button class="asset-action" title="Preview">üëÅÔ∏è</button>
                                <button class="asset-action" title="Download">‚¨áÔ∏è</button>
                                <button class="asset-action" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                        
                        <div class="asset-card" data-type="text" data-id="asset-5">
                            <div class="asset-thumbnail text">üìä</div>
                            <div class="asset-info">
                                <span class="asset-title">ANALYTICS_REPORT.csv</span>
                                <span class="asset-meta">156 KB ‚Ä¢ 3 days ago</span>
                            </div>
                            <div class="asset-actions">
                                <button class="asset-action" title="Preview">üëÅÔ∏è</button>
                                <button class="asset-action" title="Download">‚¨áÔ∏è</button>
                                <button class="asset-action" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                        
                        <div class="asset-card" data-type="image" data-id="asset-6">
                            <div class="asset-thumbnail image">üñºÔ∏è</div>
                            <div class="asset-info">
                                <span class="asset-title">SOCIAL_BANNER.jpg</span>
                                <span class="asset-meta">2.1 MB ‚Ä¢ 3 days ago</span>
                            </div>
                            <div class="asset-actions">
                                <button class="asset-action" title="Preview">üëÅÔ∏è</button>
                                <button class="asset-action" title="Download">‚¨áÔ∏è</button>
                                <button class="asset-action" title="Delete">üóëÔ∏è</button>
                            </div>
                        </div>
                        
                        <!-- UPLOAD ZONE -->
                        <div class="asset-card upload-zone" id="uploadZone">
                            <div class="upload-content">
                                <span class="upload-icon">üì§</span>
                                <p>Drop files here<br>or click to upload</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AGENTS VIEW (Hidden) -->
            <div class="workspace-content hidden" id="agentsView">
                <div class="agents-container">
                    <div class="agents-header">
                        <h2>ü§ñ Node Configuration</h2>
                        <div class="agents-actions">
                            <button class="os-btn featured-btn" id="toggle3dBtn" onclick="toggle3DView()">
                                <span class="btn-glow"></span>
                                üëÅÔ∏è 3D VIEW
                            </button>
                        </div>
                        <div class="agents-filters">
                            <select class="filter-select" id="clusterFilter">
                                <option value="all">All Clusters</option>
                                <option value="APEX">APEX</option>
                                <option value="STRATEGY">STRATEGY</option>
                                <option value="RESEARCH">RESEARCH</option>
                                <option value="CONTENT">CONTENT</option>
                                <option value="GOVERNANCE">GOVERNANCE</option>
                                <option value="INTEL">INTELLIGENCE</option>
                            </select>
                            <select class="filter-select" id="statusFilter">
                                <option value="all">All Status</option>
                                <option value="online">Online</option>
                                <option value="processing">Processing</option>
                                <option value="offline">Offline</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="grid-wrapper" style="position: relative; width: 100%; height: 100%; overflow: hidden;">
                        <!-- 3D CONTAINER -->
                        <div id="dashboard-neural-container" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; opacity: 0; transition: opacity 0.5s;"></div>
                        
                        <!-- 2D CANVAS (Legacy) -->
                        <canvas id="neuralCanvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;"></canvas>
                        
                        <!-- AGENTS GRID (Overlay) -->
                        <div class="agents-grid" id="agentsGrid" style="position: relative; z-index: 1; transition: opacity 0.5s;">
                        
                        <!-- CREATE NEW AGENT (User Action) -->
                        <div class="agent-tile create-new" id="openFoundryBtn" style="border: 1px dashed var(--accent-primary); background: rgba(0,0,0,0.3); justify-content: center; align-items: center; cursor: pointer;">
                            <div style="text-align: center;">
                                <span style="font-size: 24px; display: block; margin-bottom: 5px;">Ôºã</span>
                                <span style="font-size: 12px; color: var(--accent-primary); letter-spacing: 1px;">FABRICATE NODE</span>
                            </div>
                        </div>
              <!-- HEADER -->
            <header class="os-header">
                <div>
                    <h1 class="logo-title">AGENTICUM G5 <span style="opacity:0.5; font-weight:300;">| THE PERFECT TWIN</span></h1>
                    <div style="font-size:10px; color:var(--text-secondary); letter-spacing:2px; margin-top:2px;">DIGITAL ISOMORPHISM PROTOCOL ‚Ä¢ V5.0.0</div>
                </div>
            </header>

                        <!-- APEX -->
                        <div class="agent-tile apex" data-node="SN-00">
                            <div class="tile-header">
                                <span class="tile-icon">üëë</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">SN-00</span>
                                <span class="tile-name">Orchestrator</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 45%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 62%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">12ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- STRATEGY CLUSTER -->
                        <div class="agent-tile sp" data-node="SP-01">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">SP-01</span>
                                <span class="tile-name">Campaign Strategist</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 22%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 31%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">45ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="agent-tile sp" data-node="SP-99">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">SP-99</span>
                                <span class="tile-name">Hegemony Matrix</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 88%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 92%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">120ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- RESEARCH CLUSTER -->
                        <div class="agent-tile ra" data-node="RA-01">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">RA-01</span>
                                <span class="tile-name">Authority Auditor</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 15%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 28%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">32ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="agent-tile ra" data-node="RA-06">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">RA-06</span>
                                <span class="tile-name">Trend Forecaster</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 35%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 42%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">65ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="agent-tile ra" data-node="RA-52">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status processing"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">RA-52</span>
                                <span class="tile-name">Red Team</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill processing" style="width: 95%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 76%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">180ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- CONTENT CLUSTER -->
                        <div class="agent-tile cc" data-node="CC-01">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status processing"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">CC-01</span>
                                <span class="tile-name">Copy Chief</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill processing" style="width: 65%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 44%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">55ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="agent-tile cc" data-node="CC-06">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">CC-06</span>
                                <span class="tile-name">Video Director (Veo)</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 8%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 95%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">1.2s</span></div>
                                </div>
                            </div>
                        </div>

                        <div class="agent-tile cc" data-node="CC-07">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">CC-07</span>
                                <span class="tile-name">Imagen 3 Forge</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 12%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 85%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">900ms</span></div>
                                </div>
                            </div>
                        </div>

                        <div class="agent-tile cc" data-node="CC-08">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">CC-08</span>
                                <span class="tile-name">Flash Voice (TTS)</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 5%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 15%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">150ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- GOVERNANCE CLUSTER -->
                        <div class="agent-tile mi" data-node="MI-01">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">MI-01</span>
                                <span class="tile-name">Compliance Officer</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 5%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 10%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">8ms</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- INTEL CLUSTER -->
                        <div class="agent-tile dt" data-node="DT-02">
                            <div class="tile-header">
                                <span class="tile-icon">‚óÜ</span>
                                <span class="tile-status online"></span>
                            </div>
                            <div class="tile-body">
                                <span class="tile-id">DT-02</span>
                                <span class="tile-name">Pricing Algorithm</span>
                                <div class="node-metrics-block">
                                    <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 40%;"></div></div></div>
                                    <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 55%;"></div></div></div>
                                    <div class="metric-line"><span>LAT</span><span class="metric-val">220ms</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div> <!-- End grid-wrapper -->
                    
                    <!-- NODE STATS -->
                    <div class="node-stats">
                        <div class="stat-card">
                            <span class="stat-value" id="nodesOnline">52</span>
                            <span class="stat-label">Online</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="nodesProcessing">2</span>
                            <span class="stat-label">Processing</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="nodesOffline">0</span>
                            <span class="stat-label">Offline</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="totalClusters">6</span>
                            <span class="stat-label">Clusters</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WORKFLOWS VIEW (Hidden) -->
            <div class="workspace-content hidden" id="workflowsView">
                <div class="workflows-container">
                    <div class="workflows-header">
                        <h2>‚ö° Enterprise Workflows</h2>
                        <div class="workflow-stats">
                            <span class="wf-stat"><strong>5</strong> Workflows</span>
                            <span class="wf-stat"><strong>127</strong> Executions</span>
                            <span class="wf-stat success"><strong>98.4%</strong> Success</span>
                        </div>
                    </div>
                    
                    <!-- WORKFLOW CARDS -->
                    <div class="workflow-cards">
                        <!-- 5-MINUTE AGENCY -->
                        <div class="workflow-card" data-workflow="5min-agency">
                            <div class="wf-card-header">
                                <span class="wf-card-icon">‚ö°</span>
                                <div class="wf-card-info">
                                    <span class="wf-card-name">5-Minute Agency</span>
                                    <span class="wf-card-desc">Complete campaign from brief to launch</span>
                                </div>
                                <span class="wf-card-status ready">READY</span>
                            </div>
                            <div class="wf-card-body">
                                <div class="wf-flow">
                                    <span class="wf-node">BRIEF</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">SP-01</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">CC-01</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">CC-07</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">DEPLOY</span>
                                </div>
                                <div class="wf-card-meta">
                                    <span>üïê ~5 min</span>
                                    <span>üîó 12 nodes</span>
                                    <span>üìä 42 runs</span>
                                </div>
                            </div>
                            <div class="wf-card-actions">
                                <button class="btn btn-primary btn-small wf-run-btn">‚ñ∂ Execute</button>
                                <button class="btn btn-secondary btn-small wf-config-btn">Configure</button>
                            </div>
                        </div>
                        
                        <!-- ALGORITHMIC SENATE -->
                        <div class="workflow-card" data-workflow="senate">
                            <div class="wf-card-header">
                                <span class="wf-card-icon">‚öñÔ∏è</span>
                                <div class="wf-card-info">
                                    <span class="wf-card-name">Algorithmic Senate</span>
                                    <span class="wf-card-desc">Multi-perspective consensus building</span>
                                </div>
                                <span class="wf-card-status ready">READY</span>
                            </div>
                            <div class="wf-card-body">
                                <div class="wf-flow">
                                    <span class="wf-node">INPUT</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">5 AGENTS</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">DEBATE</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">VOTE</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">CONSENSUS</span>
                                </div>
                                <div class="wf-card-meta">
                                    <span>üïê ~8 min</span>
                                    <span>üîó 7 nodes</span>
                                    <span>üìä 28 runs</span>
                                </div>
                            </div>
                            <div class="wf-card-actions">
                                <button class="btn btn-primary btn-small wf-run-btn">‚ñ∂ Execute</button>
                                <button class="btn btn-secondary btn-small wf-config-btn">Configure</button>
                            </div>
                        </div>
                        
                        <!-- NARRATIVE MORPHOSIS -->
                        <div class="workflow-card" data-workflow="morphosis">
                            <div class="wf-card-header">
                                <span class="wf-card-icon">üîÑ</span>
                                <div class="wf-card-info">
                                    <span class="wf-card-name">Narrative Morphosis</span>
                                    <span class="wf-card-desc">Transform content across formats</span>
                                </div>
                                <span class="wf-card-status ready">READY</span>
                            </div>
                            <div class="wf-card-body">
                                <div class="wf-flow">
                                    <span class="wf-node">SOURCE</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">ANALYZE</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">TRANSFORM</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">8 FORMATS</span>
                                </div>
                                <div class="wf-card-meta">
                                    <span>üïê ~3 min</span>
                                    <span>üîó 15 nodes</span>
                                    <span>üìä 31 runs</span>
                                </div>
                            </div>
                            <div class="wf-card-actions">
                                <button class="btn btn-primary btn-small wf-run-btn">‚ñ∂ Execute</button>
                                <button class="btn btn-secondary btn-small wf-config-btn">Configure</button>
                            </div>
                        </div>
                        
                        <!-- JIT REALITY -->
                        <div class="workflow-card" data-workflow="jit-reality">
                            <div class="wf-card-header">
                                <span class="wf-card-icon">üîÆ</span>
                                <div class="wf-card-info">
                                    <span class="wf-card-name">Just-in-Time Reality</span>
                                    <span class="wf-card-desc">Predictive content generation</span>
                                </div>
                                <span class="wf-card-status ready">READY</span>
                            </div>
                            <div class="wf-card-body">
                                <div class="wf-flow">
                                    <span class="wf-node">TRENDS</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">PREDICT</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">GENERATE</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">SCHEDULE</span>
                                </div>
                                <div class="wf-card-meta">
                                    <span>üïê ~6 min</span>
                                    <span>üîó 9 nodes</span>
                                    <span>üìä 18 runs</span>
                                </div>
                            </div>
                            <div class="wf-card-actions">
                                <button class="btn btn-primary btn-small wf-run-btn">‚ñ∂ Execute</button>
                                <button class="btn btn-secondary btn-small wf-config-btn">Configure</button>
                            </div>
                        </div>
                        
                        <!-- GEMINI TRAINS GEMINI (AUTOPOIESIS) -->
                        <div class="workflow-card active" data-workflow="autopoiesis">
                            <div class="wf-card-header">
                                <span class="wf-card-icon">üîß</span>
                                <div class="wf-card-info">
                                    <span class="wf-card-name">Gemini Trains Gemini</span>
                                    <span class="wf-card-desc">Self-Reflective Loop: AI critique & optimization cycle</span>
                                </div>
                                <span class="wf-card-status running">ACTIVE</span>
                            </div>
                            <div class="wf-card-body">
                                <div class="wf-flow">
                                    <span class="wf-node">MONITOR</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">ANALYZE</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">OPTIMIZE</span>
                                    <span class="wf-arrow">‚Üí</span>
                                    <span class="wf-node">DEPLOY</span>
                                    <span class="wf-arrow">‚Ü∫</span>
                                </div>
                                <div class="wf-card-meta">
                                    <span>üïê Continuous</span>
                                    <span>üîó 18 nodes</span>
                                    <span>üìä 8 cycles</span>
                                </div>
                            </div>
                            <div class="wf-card-actions">
                                <button class="btn btn-primary btn-small wf-run-btn">‚ñ∂ Execute</button>
                                <button class="btn btn-secondary btn-small wf-config-btn">Configure</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- EXECUTION HISTORY -->
                    <div class="execution-history">
                        <h3>üìã Recent Executions</h3>
                        <div class="history-list">
                            <div class="history-item success">
                                <span class="history-icon">‚úÖ</span>
                                <span class="history-workflow">5-Minute Agency</span>
                                <span class="history-time">2 minutes ago</span>
                                <span class="history-duration">4m 32s</span>
                            </div>
                            <div class="history-item success">
                                <span class="history-icon">‚úÖ</span>
                                <span class="history-workflow">Narrative Morphosis</span>
                                <span class="history-time">15 minutes ago</span>
                                <span class="history-duration">2m 18s</span>
                            </div>
                            <div class="history-item running">
                                <span class="history-icon">üîÑ</span>
                                <span class="history-workflow">Autopoiesis</span>
                                <span class="history-time">Running</span>
                                <span class="history-duration">--</span>
                            </div>
                            <div class="history-item success">
                                <span class="history-icon">‚úÖ</span>
                                <span class="history-workflow">Algorithmic Senate</span>
                                <span class="history-time">1 hour ago</span>
                                <span class="history-duration">7m 45s</span>
                            </div>
                            <div class="history-item error">
                                <span class="history-icon">‚ùå</span>
                                <span class="history-workflow">JIT Reality</span>
                                <span class="history-time">3 hours ago</span>
                                <span class="history-duration">Failed</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PLAYGROUND VIEW (NEW PHASE 5) -->
            <div class="workspace-content hidden" id="playgroundView" style="height:100%; display:none; flex-direction:column;">
                <div class="playground-header" style="padding: 20px; border-bottom: 1px solid #333; display:flex; justify-content:space-between; align-items:center;">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <span style="font-size:24px;">üß™</span>
                        <div>
                            <h2 style="margin:0; font-size:18px; letter-spacing:1px;">NEURAL PLAYGROUND</h2>
                            <span style="font-size:12px; color:var(--text-secondary);">Direct Model Inference Sandbox</span>
                        </div>
                    </div>
                    
                    <!-- Playground Controls -->
                    <div style="display:flex; gap:15px; align-items:center;">
                        <select class="g5-select" id="playgroundModel" style="width:200px;">
                            <option value="gemini-pro">Gemini 1.5 Pro (Reasoning)</option>
                            <option value="gemini-flash">Gemini 1.5 Flash (Speed)</option>
                            <option value="gemma-27b">Gemma 2 27B (Local Sim)</option>
                        </select>
                        <div style="display:flex; align-items:center; gap:5px;">
                            <span style="font-size:12px; color:var(--text-secondary);">TEMP:</span>
                            <input type="range" class="g5-range" id="playgroundTemp" min="0" max="1" step="0.1" value="0.7" style="width:100px;">
                            <span id="tempValue" style="font-size:12px; width:25px;">0.7</span>
                        </div>
                    </div>
                </div>
                
                <div class="playground-body" style="flex:1; display:flex; overflow:hidden;">
                    <!-- LEFT: PROMPT -->
                    <div style="flex:1; display:flex; flex-direction:column; border-right:1px solid #333; padding:20px;">
                        <div style="margin-bottom:10px; display:flex; justify-content:space-between;">
                            <label style="font-size:12px; color:var(--accent-primary);">SYSTEM INSTRUCTION</label>
                            <span style="font-size:10px; color:var(--text-secondary);">Use {{ }} for variables</span>
                        </div>
                        <textarea id="playgroundSystem" style="height:150px; background:#111; border:1px solid #333; color:var(--text-secondary); padding:10px; font-family:'JetBrains Mono'; resize:none; margin-bottom:20px; font-size:12px;" placeholder="You are a helpful assistant..."></textarea>
                        
                        <div style="margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;">
                            <label style="font-size:12px; color:var(--accent-primary);">USER INPUT</label>
                            <div>
                                <button class="btn btn-secondary btn-small" id="micBtn" style="margin-right:10px;" title="Push to Talk (Voice Protocol)">üéôÔ∏è</button>
                                <button class="btn btn-primary btn-small" id="runPlaygroundBtn">‚ñ∂ RUN (Ctrl+Enter)</button>
                            </div>
                        </div>
                        <textarea id="playgroundInput" style="flex:1; background:#0a0a0a; border:1px solid #333; color:var(--text-primary); padding:15px; font-family:'JetBrains Mono'; resize:none; font-size:14px;" placeholder="Enter your prompt here..."></textarea>
                    </div>
                    
                    <!-- RIGHT: OUTPUT -->
                    <div style="flex:1; background:#050505; display:flex; flex-direction:column;">
                        <div style="padding:10px 20px; border-bottom:1px solid #333; display:flex; justify-content:space-between;">
                            <span style="font-size:12px; color:var(--text-secondary);">OUTPUT STREAM</span>
                            <span id="playgroundCost" style="font-size:12px; color:var(--text-secondary);">0 TPS</span>
                        </div>
                        <div id="playgroundOutput" style="flex:1; padding:20px; overflow-y:auto; font-family:'JetBrains Mono'; font-size:14px; line-height:1.6; color:#e5e7eb;">
                            <span style="color:#444;">// Awaiting execution...</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- EXTENSIONS VIEW (DEEP MATRIX) -->
            <div class="workspace-content hidden" id="extensionsView" style="height:100%; display:none; flex-direction:row; overflow:hidden;">
                <!-- SIDEBAR CATEGORIES -->
                <div class="extensions-sidebar" style="width:240px; background:var(--bg-elevated); border-right:1px solid #333; padding:20px; display:flex; flex-direction:column;">
                    <h2 style="font-size:18px; letter-spacing:1px; margin-bottom:20px;">MATRIX</h2>
                    <nav class="matrix-nav" style="display:flex; flex-direction:column; gap:5px;">
                        <button class="matrix-cat active" data-cat="all" style="text-align:left; padding:10px; border-radius:4px; background:rgba(255,255,255,0.05);">All Packages</button>
                        <button class="matrix-cat" data-cat="neural" style="text-align:left; padding:10px; border-radius:4px;">Neural & AI</button>
                        <button class="matrix-cat" data-cat="dev" style="text-align:left; padding:10px; border-radius:4px;">DevTools</button>
                        <button class="matrix-cat" data-cat="security" style="text-align:left; padding:10px; border-radius:4px;">Security</button>
                        <button class="matrix-cat" data-cat="legacy" style="text-align:left; padding:10px; border-radius:4px;">Legacy</button>
                    </nav>
                </div>

                <!-- MAIN GRID -->
                <div style="flex:1; display:flex; flex-direction:column; height:100%;">
                    <div style="padding:20px; border-bottom:1px solid #333; display:flex; justify-content:space-between; align-items:center;">
                        <h2 id="matrixTitle" style="margin:0; font-size:20px;">All Packages</h2>
                        <input type="text" id="matrixSearch" placeholder="Search Matrix..." style="background:#111; border:1px solid #333; padding:8px 12px; color:#fff; border-radius:4px; width:200px; font-family:'JetBrains Mono';">
                    </div>
                    <div class="extensions-grid" id="extensionsGrid" style="flex:1; overflow-y:auto; padding:20px; display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:20px; align-content:start;">
                        <!-- DYNAMICALLY POPULATED -->
                    </div>
                </div>
            </div>
            <!-- SYSTEM LOGS VIEW (ENTERPRISE AUDIT) -->
            <div class="workspace-content hidden" id="logsView" style="height:100%; display:none; flex-direction:column;">
                <div class="logs-header" style="padding: 20px; border-bottom: 1px solid #333; display:flex; justify-content:space-between; align-items:center;">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <span style="font-size:24px;">üìã</span>
                        <div>
                            <h2 style="margin:0; font-size:18px; letter-spacing:1px;">SYSTEM AUDIT TRAIL</h2>
                            <span style="font-size:12px; color:var(--text-secondary);">Enterprise Operational Integrity Logs</span>
                        </div>
                    </div>
                    <div style="display:flex; gap:10px;">
                        <button class="btn btn-secondary btn-small" id="clearAudit">CLEAR LOGS</button>
                        <button class="btn btn-primary btn-small" id="exportAudit">EXPORT PDF/JSON</button>
                    </div>
                </div>
                <div class="logs-body" style="flex:1; overflow:hidden; display:flex; flex-direction:column; padding:0;">
                    <table class="audit-table" style="width:100%; border-collapse:collapse; color:var(--text-secondary); font-size:11px; font-family:'JetBrains Mono';">
                        <thead style="background:#111; position:sticky; top:0; z-index:10;">
                            <tr>
                                <th style="text-align:left; padding:12px 20px; border-bottom:1px solid #333;">TIMESTAMP</th>
                                <th style="text-align:left; padding:12px; border-bottom:1px solid #333;">NODE_ID</th>
                                <th style="text-align:left; padding:12px; border-bottom:1px solid #333;">EVENT_TYPE</th>
                                <th style="text-align:left; padding:12px; border-bottom:1px solid #333;">DESCRIPTION</th>
                                <th style="text-align:right; padding:12px 20px; border-bottom:1px solid #333;">INTEGRITY_SALT</th>
                            </tr>
                        </thead>
                        <tbody id="auditTrailBody">
                            <!-- DYNAMIC LOGS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- AGENT FOUNDRY MODAL (FABRICATE NODE) -->
        <div id="agent-foundry-modal" class="modal hidden" style="z-index: 2000; background: rgba(0,0,0,0.85); display:none; justify-content:center; align-items:center;">
            <div class="modal-content industrial-modal" style="width: 800px; height: 600px; display:flex;">
                <!-- PREVIEW COLUMN -->
                <div class="foundry-preview" style="flex:1; background:#050505; border-right:1px solid #333; padding:20px; display:flex; flex-direction:column; align-items:center; justify-content:center;">
                    <div class="agent-tile active-demo-node" id="foundryPreviewTile" style="width:200px; height:200px; transform:scale(1.2);">
                        <div class="tile-header">
                            <span class="tile-icon" id="previewIcon">‚óÜ</span>
                            <span class="tile-status online"></span>
                        </div>
                        <div class="tile-body">
                            <span class="tile-id" id="previewId">XX-00</span>
                            <span class="tile-name" id="previewName">New Node</span>
                            <div class="node-metrics-block">
                                <div class="metric-line"><span>vCPU</span><div class="metric-bar"><div class="bar-fill" style="width: 100%;"></div></div></div>
                                <div class="metric-line"><span>MEM</span><div class="metric-bar"><div class="bar-fill" style="width: 100%;"></div></div></div>
                                <div class="metric-line"><span>LAT</span><span class="metric-val">0ms</span></div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top:30px; text-align:center;">
                        <h3 style="color:var(--text-secondary); font-size:12px; letter-spacing:2px;">VISUALIZATION</h3>
                        <div style="margin-top:10px; display:flex; gap:10px; justify-content:center;">
                             <input type="color" id="foundryColor" value="#4ade80" style="background:none; border:none; width:30px; height:30px; cursor:pointer;">
                             <span id="foundryColorHex" style="font-family:'JetBrains Mono'; font-size:12px; color:#fff; line-height:30px;">#4ade80</span>
                        </div>
                    </div>
                </div>

                <!-- CONFIG COLUMN -->
                <div class="foundry-config" style="flex:1; padding:30px; overflow-y:auto;">
                    <h2 style="font-family:'Rajdhani'; font-size:24px; margin-bottom:5px;">FABRICATE NODE</h2>
                    <p style="font-size:12px; color:var(--text-secondary); margin-bottom:30px;">Define neural architecture and role constraints.</p>

                    <div class="form-group" style="margin-bottom:20px;">
                        <label style="display:block; font-size:10px; color:var(--text-secondary); letter-spacing:1px; margin-bottom:5px;">DESIGNATION ID</label>
                        <input type="text" id="foundryId" style="width:100%; background:#111; border:1px solid #333; padding:10px; color:#fff; font-family:'JetBrains Mono';" value="XX-99">
                    </div>

                    <div class="form-group" style="margin-bottom:20px;">
                        <label style="display:block; font-size:10px; color:var(--text-secondary); letter-spacing:1px; margin-bottom:5px;">NODE NAME</label>
                        <input type="text" id="foundryName" style="width:100%; background:#111; border:1px solid #333; padding:10px; color:#fff; font-family:'JetBrains Mono';" value="New Agent">
                    </div>

                    <div class="form-group" style="margin-bottom:20px;">
                        <label style="display:block; font-size:10px; color:var(--text-secondary); letter-spacing:1px; margin-bottom:5px;">CLUSTER</label>
                        <select id="foundryCluster" class="g5-select" style="width:100%;">
                            <option value="STRATEGY">STRATEGY</option>
                            <option value="CONTENT">CONTENT</option>
                            <option value="RESEARCH">RESEARCH</option>
                            <option value="GOVERNANCE">GOVERNANCE</option>
                            <option value="INTEL">INTELLIGENCE</option>
                        </select>
                    </div>

                    <div class="form-group" style="margin-bottom:30px;">
                         <label style="display:block; font-size:10px; color:var(--text-secondary); letter-spacing:1px; margin-bottom:5px;">SYSTEM PROMPT</label>
                         <textarea id="foundryPrompt" style="width:100%; height:100px; background:#111; border:1px solid #333; padding:10px; color:#fff; font-family:'JetBrains Mono'; resize:none;">You are a specialized G5 node.</textarea>
                    </div>

                    <div style="display:flex; gap:10px; justify-content:flex-end;">
                        <button class="btn btn-secondary" id="closeFoundry">CANCEL</button>
                        <button class="btn btn-primary" id="spawnAgentBtn">INITIALIZE NODE</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT PANEL: AGENT CONFIGURATION -->
        <aside class="os-panel os-panel-right" id="rightPanel">
            <div class="panel-resize-handle" data-panel="right"></div>
            
            <!-- ACTIVE AGENT -->
            <div class="panel-section agent-config">
                <div class="section-header">
                    <span class="section-icon">ü§ñ</span>
                    <span>ACTIVE AGENT</span>
                </div>
                <div class="agent-card">
                    <div class="agent-avatar">
                        <span class="avatar-icon">‚óÜ</span>
                    </div>
                    <div class="agent-info">
                        <span class="agent-name">SN-00 Orchestrator</span>
                        <span class="agent-role">APEX NODE</span>
                    </div>
                    <span class="agent-status online">ONLINE</span>
                </div>
                
                <!-- AGENT BRIEFING -->
                <div class="agent-briefing">
                    <label class="briefing-label">AGENT BRIEFING</label>
                    <textarea class="briefing-input" id="agentBriefing" placeholder="Define agent behavior, constraints, and objectives...">You are the central orchestrator of a 52-node cognitive mesh. Coordinate strategy, content, research, and governance clusters for optimal marketing outcomes. Prioritize ethical compliance and strategic dominance.</textarea>
                </div>
                
                <!-- AGENT TRAITS -->
                <div class="agent-traits">
                    <label class="traits-label">PERSONALITY TRAITS</label>
                    <div class="trait-toggles">
                        <label class="trait-toggle">
                            <input type="checkbox" checked>
                            <span class="trait-name">Strategic</span>
                        </label>
                        <label class="trait-toggle">
                            <input type="checkbox" checked>
                            <span class="trait-name">Decisive</span>
                        </label>
                        <label class="trait-toggle">
                            <input type="checkbox">
                            <span class="trait-name">Creative</span>
                        </label>
                        <label class="trait-toggle">
                            <input type="checkbox" checked>
                            <span class="trait-name">Analytical</span>
                        </label>
                        <label class="trait-toggle">
                            <input type="checkbox">
                            <span class="trait-name">Experimental</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- CONTEXT WINDOW -->
            <div class="panel-section">
                <div class="section-header">
                    <span class="section-icon">üìã</span>
                    <span>CONTEXT</span>
                    <button class="section-action" title="Clear Context">üóëÔ∏è</button>
                </div>
                <div class="context-files" id="contextFiles">
                    <div class="context-file">
                        <span class="file-icon">üìÑ</span>
                        <span class="file-name">BRAND_GUIDELINES.pdf</span>
                        <button class="file-remove">√ó</button>
                    </div>
                    <div class="context-file">
                        <span class="file-icon">üìä</span>
                        <span class="file-name">MARKET_DATA_Q4.xlsx</span>
                        <button class="file-remove">√ó</button>
                    </div>
                </div>
                <button class="add-context-btn" id="addContextBtn">
                    + Add Context File
                </button>
            </div>

            <!-- NODE MESH STATUS -->
            <div class="panel-section">
                <div class="section-header">
                    <span class="section-icon">üîÆ</span>
                    <span>NODE MESH</span>
                </div>
                <div class="mesh-visualization" id="meshViz">
                    <div class="mesh-cluster">
                        <span class="cluster-name">STRATEGY</span>
                        <div class="cluster-nodes">
                            <span class="node-dot online" title="SP-01"></span>
                            <span class="node-dot online" title="SP-99"></span>
                            <span class="node-dot online" title="SP-77"></span>
                        </div>
                    </div>
                    <div class="mesh-cluster">
                        <span class="cluster-name">RESEARCH</span>
                        <div class="cluster-nodes">
                            <span class="node-dot online" title="RA-01"></span>
                            <span class="node-dot online" title="RA-06"></span>
                            <span class="node-dot online" title="RA-52"></span>
                        </div>
                    </div>
                    <div class="mesh-cluster">
                        <span class="cluster-name">CONTENT</span>
                        <div class="cluster-nodes">
                            <span class="node-dot processing" title="CC-01"></span>
                            <span class="node-dot online" title="CC-06"></span>
                            <span class="node-dot online" title="CC-08"></span>
                            <span class="node-dot online" title="CC-13"></span>
                        </div>
                    </div>
                    <div class="mesh-cluster">
                        <span class="cluster-name">GOVERNANCE</span>
                        <div class="cluster-nodes">
                            <span class="node-dot online" title="MI-01"></span>
                            <span class="node-dot online" title="MI-07"></span>
                        </div>
                    </div>
                    <div class="mesh-cluster">
                        <span class="cluster-name">INTEL</span>
                        <div class="cluster-nodes">
                            <span class="node-dot online" title="DT-02"></span>
                            <span class="node-dot online" title="DT-04"></span>
                        </div>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- ============================================
         BOTTOM PANEL: TERMINAL / LOGS
         ============================================ -->
    <footer class="os-footer" id="bottomPanel">
        <div class="panel-resize-handle" data-panel="bottom"></div>
        
        <div class="footer-tabs">
            <button class="footer-tab active" data-panel="terminal">
                <span class="tab-icon">‚å®Ô∏è</span>
                <span>Terminal</span>
            </button>
            <button class="footer-tab" data-panel="logs">
                <span class="tab-icon">üìã</span>
                <span>Reasoning Log</span>
            </button>
            <button class="footer-tab" data-panel="output">
                <span class="tab-icon">üì§</span>
                <span>Output</span>
            </button>
            <button class="footer-tab" data-panel="problems">
                <span class="tab-icon">‚ö†Ô∏è</span>
                <span>Problems</span>
                <span class="tab-badge">0</span>
            </button>
        </div>

        <!-- TERMINAL -->
        <div class="footer-content" id="terminalPanel">
            <div class="terminal-output" id="terminalOutput">
                <div class="term-line system">[SYSTEM] AGENTICUM G5 OPERATING SYSTEM V5.0.1</div>
                <div class="term-line">[SN-00] Orchestrator initialized. 52 nodes online.</div>
                <div class="term-line success">[READY] Awaiting operator commands...</div>
            </div>
            <div class="terminal-input-line">
                <span class="terminal-prompt">g5 ></span>
                <input type="text" class="terminal-input" id="terminalInput" placeholder="Enter system command...">
            </div>
        </div>

        <!-- REASONING LOG (Hidden) -->
        <div class="footer-content hidden" id="logsPanel">
            <div class="log-entries" id="logEntries">
                <div class="log-entry">
                    <span class="log-time">01:12:34</span>
                    <span class="log-node">[SN-00]</span>
                    <span class="log-msg">System boot sequence complete</span>
                </div>
            </div>
        </div>

        <!-- OUTPUT (Hidden) -->
        <div class="footer-content hidden" id="outputPanel">
            <div class="output-content">
                <p class="output-placeholder">Generated output will appear here...</p>
            </div>
        </div>

        <!-- PROBLEMS (Hidden) -->
        <div class="footer-content hidden" id="problemsPanel">
            <div class="problems-list">
                <p class="no-problems">‚úì No problems detected</p>
            </div>
        </div>

        <div class="footer-controls">
            <button class="footer-btn" id="togglePanelBtn" title="Toggle Panel">‚ñº</button>
            <button class="footer-btn" id="clearTerminalBtn" title="Clear">üóëÔ∏è</button>
        </div>
    </footer>

    <!-- HIDDEN FILE INPUT -->
    <input type="file" id="fileInput" class="hidden" accept="*/*">
    <input type="file" id="contextFileInput" class="hidden" accept="*/*" multiple>

    <!-- ============================================
         COMMAND PALETTE (Ctrl+K)
         ============================================ -->
    <div class="command-palette hidden" id="commandPalette">
        <div class="palette-backdrop"></div>
        <div class="palette-container">
            <div class="palette-input-wrapper">
                <span class="palette-icon">‚åò</span>
                <input type="text" class="palette-input" id="paletteInput" placeholder="Search commands, nodes, workflows...">
                <span class="palette-shortcut">ESC</span>
            </div>
            <div class="palette-results" id="paletteResults">
                <div class="palette-section">
                    <div class="palette-section-title">QUICK ACTIONS</div>
                    <div class="palette-item" data-action="new-chat">
                        <span class="item-icon">üí¨</span>
                        <span class="item-label">New Chat</span>
                        <span class="item-shortcut">Ctrl+N</span>
                    </div>
                    <div class="palette-item" data-action="toggle-terminal">
                        <span class="item-icon">‚å®Ô∏è</span>
                        <span class="item-label">Toggle Terminal</span>
                        <span class="item-shortcut">Ctrl+`</span>
                    </div>
                    <div class="palette-item" data-action="open-settings">
                        <span class="item-icon">‚öôÔ∏è</span>
                        <span class="item-label">Open Settings</span>
                        <span class="item-shortcut">Ctrl+,</span>
                    </div>
                </div>
                <div class="palette-section">
                    <div class="palette-section-title">WORKFLOWS</div>
                    <div class="palette-item" data-action="workflow" data-workflow="5min-agency">
                        <span class="item-icon">‚ö°</span>
                        <span class="item-label">5-Minute Agency</span>
                    </div>
                    <div class="palette-item" data-action="workflow" data-workflow="senate">
                        <span class="item-icon">‚öñÔ∏è</span>
                        <span class="item-label">Algorithmic Senate</span>
                    </div>
                    <div class="palette-item" data-action="workflow" data-workflow="morphosis">
                        <span class="item-icon">üîÑ</span>
                        <span class="item-label">Narrative Morphosis</span>
                    </div>
                </div>
                <div class="palette-section">
                    <div class="palette-section-title">NODES</div>
                    <div class="palette-item" data-action="select-node" data-node="SN-00">
                        <span class="item-icon node-apex">‚óÜ</span>
                        <span class="item-label">SN-00 Orchestrator</span>
                    </div>
                    <div class="palette-item" data-action="select-node" data-node="SP-01">
                        <span class="item-icon node-sp">‚óÜ</span>
                        <span class="item-label">SP-01 Campaign Strategist</span>
                    </div>
                    <div class="palette-item" data-action="select-node" data-node="CC-01">
                        <span class="item-icon node-cc">‚óÜ</span>
                        <span class="item-label">CC-01 Copy Chief</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AGENT FOUNDRY MODAL (NEW PHASE 5) -->
    <div class="g5-modal hidden" id="agentFoundryModal">
        <div class="modal-backdrop"></div>
        <div class="modal-content" style="max-width: 800px; border: 1px solid var(--accent-primary);">
            <div class="modal-header">
                <h2 style="color:var(--accent-primary);"><span class="icon">üß¨</span> AGENT FOUNDRY <span style="font-size:0.6em; opacity:0.7;">// NEURAL FABRICATION</span></h2>
                <button class="close-modal" id="closeFoundry">√ó</button>
            </div>
            <div class="modal-body" style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                <!-- Left: Identity -->
                <div class="foundry-section">
                    <h3 style="border-bottom:1px solid #333; padding-bottom:5px; margin-bottom:15px; color:var(--text-secondary);">IDENTITY MATRIX</h3>
                    <div class="form-group">
                        <label>Designation (Name)</label>
                        <input type="text" class="g5-input" id="foundryName" placeholder="e.g. OMEGA-CODEX">
                    </div>
                    <div class="form-group">
                        <label>Functional Role</label>
                        <select class="g5-select" id="foundryRole">
                            <option value="STRATEGIST">Strategist (Reasoning)</option>
                            <option value="CODER">Technomancer (Code)</option>
                            <option value="CREATIVE">Visionary (Image/Video)</option>
                            <option value="ANALYST">Oracle (Data)</option>
                            <option value="SECURITY">Sentinel (Security)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Hex Color Signature</label>
                        <div style="display:flex; gap:10px; align-items:center;">
                            <input type="color" id="foundryColor" value="#3b82f6" style="background:none; border:none; height:30px; width:30px; cursor:pointer;">
                            <span id="foundryColorHex" style="font-family:monospace; color:var(--text-secondary);">#3b82f6</span>
                        </div>
                    </div>
                </div>

                <!-- Right: Cognition -->
                <div class="foundry-section">
                    <h3 style="border-bottom:1px solid #333; padding-bottom:5px; margin-bottom:15px; color:var(--text-secondary);">COGNITIVE KERNEL</h3>
                    <div class="form-group">
                        <label>System Instruction (Prompt)</label>
                        <textarea class="g5-input" id="foundryPrompt" style="height:150px; font-family:monospace; font-size:12px;" placeholder="Define the agent's prime directive, behavioral constraints, and expertise..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Creativity Index (Temp)</label>
                        <input type="range" class="g5-range" id="foundryTemp" min="0" max="1" step="0.1" value="0.7">
                        <div style="display:flex; justify-content:space-between; font-size:10px; color:var(--text-secondary);">
                            <span>Precise</span>
                            <span>Balanced</span>
                            <span>Wild</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="display:flex; justify-content:space-between; align-items:center; margin-top:20px; border-top:1px solid #333; padding-top:20px;">
                <div style="font-size:11px; color:var(--text-secondary);">
                    <span>COST: </span><span style="color:var(--accent-primary);">500 COMPUTE CREDITS</span>
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="btn btn-secondary" id="resetFoundry">RESET</button>
                    <button class="btn btn-primary" id="spawnAgentBtn">üß¨ SPAWN NODE</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- SETTINGS MODAL (EXISTING) -->
    <div class="g5-modal hidden" id="settingsModal">
        <div class="modal-backdrop"></div>
        <div class="modal-container modal-lg">
            <div class="modal-header">
                <h2 class="modal-title">‚öôÔ∏è Settings</h2>
                <button class="modal-close" id="closeSettings">√ó</button>
            </div>
            <div class="modal-body settings-body">
                <div class="settings-sidebar">
                    <button class="settings-nav active" data-section="general">General</button>
                    <button class="settings-nav" data-section="appearance">Appearance</button>
                    <button class="settings-nav" data-section="nodes">Nodes</button>
                    <button class="settings-nav" data-section="api">API & Backend</button>
                    <button class="settings-nav" data-section="foundry">Media Foundry</button>
                    <button class="settings-nav" data-section="shortcuts">Shortcuts</button>
                    <button class="settings-nav" data-section="about">About</button>
                </div>
                <div class="settings-content">
                    <!-- General Settings -->
                    <div class="settings-section active" id="settings-general">
                        <h3>System Preferences</h3>
                        
                        <!-- OPERATOR PROFILE PROFILE (ENTERPRISE) -->
                        <div class="setting-group" style="padding:15px; background:rgba(255,255,255,0.03); border-radius:6px; border:1px solid var(--border-color); margin-bottom:20px;">
                            <label class="setting-label" style="color:var(--text-primary); margin-bottom:10px;">Operator Identity</label>
                            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                                <div class="form-group">
                                    <label style="font-size:0.7em; color:var(--text-secondary);">Codename / ID</label>
                                    <input type="text" class="g5-input" id="profileName" value="YILDIRIM" placeholder="ENTER ID">
                                </div>
                                <div class="form-group">
                                    <label style="font-size:0.7em; color:var(--text-secondary);">Clearance Level</label>
                                    <select class="g5-select" id="profileRole">
                                        <option value="sysadmin">SYSADMIN (L5)</option>
                                        <option value="commander">COMMANDER (L4)</option>
                                        <option value="observer">OBSERVER (L1)</option>
                                    </select>
                                </div>
                            </div>
                            <button class="btn btn-primary btn-small" id="saveProfile" style="margin-top:10px; width:100%;">Update Identity</button>
                        </div>

                        <div class="setting-group">
                            <label class="setting-label">Theme Mode</label>
                            <input type="text" class="setting-input" id="operatorName" value="OPERATOR_YILDIRIM">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Default Workflow</label>
                            <select class="setting-select" id="defaultWorkflow">
                                <option value="autopoiesis">Autopoiesis</option>
                                <option value="5min-agency">5-Minute Agency</option>
                                <option value="senate">Algorithmic Senate</option>
                                <option value="morphosis">Narrative Morphosis</option>
                                <option value="jit-reality">Just-in-Time Reality</option>
                            </select>
                        </div>
                        <div class="setting-group">
                            <label class="setting-toggle-label">
                                <input type="checkbox" id="autoSave" checked>
                                <span class="toggle-slider"></span>
                                Auto-save assets to vault
                            </label>
                        </div>
                        <div class="setting-group">
                            <label class="setting-toggle-label">
                                <input type="checkbox" id="soundEffects">
                                <span class="toggle-slider"></span>
                                Sound effects
                            </label>
                        </div>
                    </div>
                    
                    <!-- Appearance Settings -->
                    <div class="settings-section" id="settings-appearance">
                        <h3>Appearance</h3>
                        <div class="setting-group">
                            <label class="setting-label">Theme</label>
                            <div class="theme-options">
                                <button class="theme-btn active" data-theme="obsidian">
                                    <span class="theme-preview obsidian"></span>
                                    <span>Obsidian</span>
                                </button>
                                <button class="theme-btn" data-theme="midnight">
                                    <span class="theme-preview midnight"></span>
                                    <span>Midnight</span>
                                </button>
                                <button class="theme-btn" data-theme="terminal">
                                    <span class="theme-preview terminal"></span>
                                    <span>Terminal</span>
                                </button>
                            </div>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Font Size</label>
                            <input type="range" class="setting-range" id="fontSize" min="11" max="16" value="13">
                            <span class="range-value">13px</span>
                        </div>
                        <div class="setting-group">
                            <label class="setting-toggle-label">
                                <input type="checkbox" id="animations" checked>
                                <span class="toggle-slider"></span>
                                Enable animations
                            </label>
                        </div>
                        
                        <!-- NEW LAYOUT CONTROLS -->
                        <div class="setting-group">
                            <label class="setting-label">Sidebar Width</label>
                            <input type="range" class="setting-range" id="layoutSidebar" min="200" max="400" value="260">
                            <span class="range-value" id="valSidebar">260px</span>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Terminal Height</label>
                            <input type="range" class="setting-range" id="layoutTerminal" min="100" max="500" value="200">
                            <span class="range-value" id="valTerminal">200px</span>
                        </div>
                        <div class="setting-group">
                             <button class="btn btn-secondary btn-small" id="resetLayout">Reset Layout</button>
                        </div>
                    </div>

                    <!-- BRANDING KIT (ENTERPRISE) -->
                    <div class="settings-section" id="settings-branding">
                        <h3>Enterprise Branding</h3>
                        <div class="setting-group">
                            <label class="setting-label">Primary Signal Color</label>
                            <div class="color-picker-grid">
                                <button class="color-btn active" style="background:#3b82f6;" data-color="#3b82f6"></button>
                                <button class="color-btn" style="background:#d946ef;" data-color="#d946ef"></button>
                                <button class="color-btn" style="background:#10b981;" data-color="#10b981"></button>
                                <button class="color-btn" style="background:#f59e0b;" data-color="#f59e0b"></button>
                                <button class="color-btn" style="background:#ef4444;" data-color="#ef4444"></button>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-top:15px;">
                            <label class="setting-label">Brand Tone of Voice</label>
                            <select class="g5-select" id="brandTone" style="width:100%;">
                                <option value="corporate">Corporate Professional</option>
                                <option value="disruptive">Disruptive / Edgy</option>
                                <option value="friendly">Friendly & Approachable</option>
                                <option value="academic">Academic / Scientific</option>
                            </select>
                        </div>

                        <div class="form-group" style="margin-top:20px;">
                            <label class="setting-label">Upload Brand Assets (Logo/Fonts)</label>
                            <div class="upload-zone-mini" id="brandUploadZone" style="border:1px dashed var(--border-color); padding:20px; text-align:center; border-radius:4px; cursor:pointer;">
                                <span style="font-size:20px;">üì§</span>
                                <p style="font-size:0.8em; color:var(--text-secondary); margin-top:5px;">Click to upload style guide</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Nodes Settings -->
                    <div class="settings-section" id="settings-nodes">
                        <h3>Node Configuration</h3>
                        <div class="setting-group">
                            <label class="setting-label">Active Clusters</label>
                            <div class="cluster-toggles">
                                <label class="cluster-toggle"><input type="checkbox" checked> Strategy (3)</label>
                                <label class="cluster-toggle"><input type="checkbox" checked> Research (8)</label>
                                <label class="cluster-toggle"><input type="checkbox" checked> Content (32)</label>
                                <label class="cluster-toggle"><input type="checkbox" checked> Governance (4)</label>
                                <label class="cluster-toggle"><input type="checkbox" checked> Intelligence (4)</label>
                            </div>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Default Agent</label>
                            <select class="setting-select" id="defaultAgent">
                                <option value="SN-00">SN-00 Orchestrator (APEX)</option>
                                <option value="SP-01">SP-01 Campaign Strategist</option>
                                <option value="CC-01">CC-01 Copy Chief</option>
                                <option value="RA-01">RA-01 Authority Auditor</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- API Settings -->
                    <div class="settings-section" id="settings-api">
                        <h3>API & Backend</h3>
                        <div class="setting-group">
                            <label class="setting-label">API Endpoint</label>
                            <input type="text" class="setting-input" id="apiEndpoint" value="https://us-central1-tutorai-e39uu.cloudfunctions.net/agenticSwarm" readonly>
                            <span class="setting-hint">Configured via Firebase Functions</span>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Google API Key</label>
                            <input type="password" class="setting-input" id="googleApiKey" placeholder="Enter your Gemini API Key...">
                            <p class="setting-desc">Stored locally in your browser for secure API calls.</p>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Connection Status</label>
                            <div class="connection-status">
                                <span class="status-indicator pending"></span>
                                <span id="connectionStatus">Checking...</span>
                                <button class="btn-small" id="testConnection">Test Connection</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Media Foundry (Enterprise Multimodal) -->
                    <div class="settings-section" id="settings-foundry">
                        <h3>Media Foundry & Synthesis</h3>
                        <p class="section-desc">Enterprise-grade controls for Imagen 3, Veo, and Cloud TTS.</p>

                        <!-- IMAGEN 3 CONFIG -->
                        <div class="foundry-cluster">
                            <h4><span class="icon">üñºÔ∏è</span> Imagen 3: Industrial Visuals</h4>
                            <div class="setting-group col-2">
                                <div>
                                    <label class="setting-label">Aspect Ratio</label>
                                    <select class="setting-select" id="imgAspectRatio">
                                        <option value="1:1">1:1 (Square)</option>
                                        <option value="9:16" selected>9:16 (Vertical)</option>
                                        <option value="16:9">16:9 (Cinematic)</option>
                                        <option value="3:4">3:4 (Portrait)</option>
                                        <option value="4:3">4:3 (Landscape)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="setting-label">Safety Filter</label>
                                    <select class="setting-select" id="imgSafety">
                                        <option value="BLOCK_MED_AND_ABOVE">Standard</option>
                                        <option value="BLOCK_ONLY_HIGH">High Velocity</option>
                                        <option value="BLOCK_NONE">Unfiltered (Admin)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="setting-group">
                                <label class="setting-label">Atmosphere / Style</label>
                                <input type="text" class="setting-input" id="imgStyle" placeholder="e.g. Industrial, Obsidian, Hyper-Realistic...">
                            </div>
                        </div>

                        <!-- VEO CONFIG -->
                        <div class="foundry-cluster">
                            <h4><span class="icon">üé¨</span> Veo: Cinematics</h4>
                            <div class="setting-group col-2">
                                <div>
                                    <label class="setting-label">Target FPS</label>
                                    <select class="setting-select" id="veoFps">
                                        <option value="24">24 FPS (Film)</option>
                                        <option value="30" selected>30 FPS (Standard)</option>
                                        <option value="60">60 FPS (Fluid)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="setting-label">Duration</label>
                                    <select class="setting-select" id="veoDuration">
                                        <option value="6">6 Seconds</option>
                                        <option value="10">10 Seconds</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- TTS CONFIG -->
                        <div class="foundry-cluster">
                            <h4><span class="icon">üéôÔ∏è</span> Cloud TTS: Neural Voice</h4>
                            <div class="setting-group col-2">
                                <div>
                                    <label class="setting-label">Model Selection</label>
                                    <select class="setting-select" id="ttsVoice">
                                        <option value="en-US-Journey-F">Neural Journey (F)</option>
                                        <option value="en-US-Journey-D">Neural Journey (M)</option>
                                        <option value="en-GB-Standard-A">Studio British (F)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="setting-label">Speech Velocity</label>
                                    <input type="range" class="setting-range" id="ttsSpeed" min="0.5" max="2.0" step="0.1" value="1.0">
                                    <span class="range-val" id="ttsSpeedVal">1.0x</span>
                                </div>
                            </div>
                            <div class="setting-group">
                                <label class="setting-toggle-label">
                                    <input type="checkbox" id="ttsAutoPlay" checked>
                                    <span class="toggle-slider"></span>
                                    Auto-synthesize system responses
                                </label>
                            </div>
                        </div>
                    
                    <!-- Shortcuts Settings -->
                    <div class="settings-section" id="settings-shortcuts">
                        <h3>Keyboard Shortcuts</h3>
                        <div class="shortcuts-list">
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Ctrl</kbd>+<kbd>K</kbd></span>
                                <span class="shortcut-desc">Open Command Palette</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Ctrl</kbd>+<kbd>N</kbd></span>
                                <span class="shortcut-desc">New Chat</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Ctrl</kbd>+<kbd>`</kbd></span>
                                <span class="shortcut-desc">Toggle Terminal</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Ctrl</kbd>+<kbd>,</kbd></span>
                                <span class="shortcut-desc">Open Settings</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Ctrl</kbd>+<kbd>B</kbd></span>
                                <span class="shortcut-desc">Toggle Left Panel</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>B</kbd></span>
                                <span class="shortcut-desc">Toggle Right Panel</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Ctrl</kbd>+<kbd>Enter</kbd></span>
                                <span class="shortcut-desc">Send Message</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-keys"><kbd>Esc</kbd></span>
                                <span class="shortcut-desc">Close Modal/Palette</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- About -->
                    <div class="settings-section" id="settings-about">
                        <h3>About AGENTICUM G5</h3>
                        <div class="about-content">
                            <div class="about-logo">‚óÜ AGENTICUM G5</div>
                            <p class="about-version">Version 5.0.1_RC</p>
                            <p class="about-tagline">Industrial Autonomous Marketing OS</p>
                            <div class="about-stats">
                                <div class="stat">
                                    <span class="stat-value">52</span>
                                    <span class="stat-label">AI Nodes</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value">5</span>
                                    <span class="stat-label">Workflows</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value">2M</span>
                                    <span class="stat-label">Token Context</span>
                                </div>
                            </div>
                            <p class="about-credit">Created by Yahya Yildirim</p>
                            <p class="about-credit">Google DeepMind Gemini Hackathon 2026</p>
                            <div class="about-links">
                                <a href="https://github.com/yoyo967/-agenticum-g5-os" target="_blank">GitHub</a>
                                <a href="AGENTICUM_G5_HANDBOOK.md" target="_blank">Documentation</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================
         NOTIFICATION TOAST CONTAINER
         ============================================ -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- ============================================
         ASSET PREVIEW MODAL
         ============================================ -->
    <!-- Added style="z-index: 9999" to force it on top of everything -->
    <div class="modal hidden" id="assetPreviewModal" style="z-index: 9999 !important;">
        <div class="modal-backdrop" style="z-index: 9998 !important; background: rgba(0,0,0,0.85);"></div>
        <div class="modal-container modal-lg" style="z-index: 10000 !important; border: 1px solid var(--accent-primary);">
            <div class="modal-header">
                <h2 class="modal-title" id="assetPreviewTitle">üìÑ Asset Preview</h2>
                <button class="modal-close" id="closeAssetPreview">√ó</button>
            </div>
            <div class="modal-body asset-preview-body">
                <div class="asset-preview-content" id="assetPreviewContent">
                    <!-- Asset content rendered here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary hidden" id="saveAsset">üíæ Save Changes</button>
                <button class="btn btn-secondary" id="copyAsset">üìã Copy</button>
                <button class="btn btn-secondary" id="downloadAsset">‚¨áÔ∏è Download</button>
                <button class="btn btn-primary" id="editAsset">‚úèÔ∏è Edit</button>
            </div>
        </div>
    </div>

    <!-- ============================================
         WORKFLOW EXECUTION MODAL
         ============================================ -->
    <div class="modal hidden" id="workflowModal">
        <div class="modal-backdrop"></div>
        <div class="modal-container modal-lg">
            <div class="modal-header">
                <h2 class="modal-title" id="workflowModalTitle">‚ö° Workflow Execution</h2>
                <button class="modal-close" id="closeWorkflow">√ó</button>
            </div>
            <div class="modal-body workflow-modal-body">
                <div class="workflow-input-section">
                    <label>Input / Briefing</label>
                    <textarea class="workflow-input" id="workflowInput" placeholder="Describe your objective..."></textarea>
                    <div class="workflow-input-actions">
                        <button class="btn btn-small" id="workflowAttach">üìé Attach Files</button>
                        <span class="attached-count" id="attachedCount">0 files</span>
                    </div>
                </div>
                <div class="workflow-progress-section hidden" id="workflowProgress">
                    <label>Progress</label>
                    <div class="progress-bar">
                        <div class="progress-fill" id="workflowProgressFill"></div>
                    </div>
                    <div class="progress-steps" id="workflowSteps"></div>
                </div>
                <div class="workflow-output-section hidden" id="workflowOutput">
                    <label>Output</label>
                    <div class="workflow-output-content" id="workflowOutputContent"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelWorkflow">Cancel</button>
                <button class="btn btn-primary" id="executeWorkflow">‚ö° Execute</button>
            </div>
        </div>
    </div>

    <!-- ============================================
         WORKFLOW CONFIGURATION MODAL
         ============================================ -->
    <div class="modal hidden" id="workflowConfigModal">
        <div class="modal-backdrop"></div>
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">‚öôÔ∏è Configure Protocol</h2>
                <button class="modal-close" id="closeWorkflowConfig">√ó</button>
            </div>
            <div class="modal-body">
                <div class="config-section">
                    <h4 id="configWorkflowName">WORKFLOW_ID</h4>
                    <p class="config-desc">Adjust parameters for the next execution cycle.</p>
                </div>
                
                <div class="form-group">
                    <label>Recursion Depth (Quality vs Speed)</label>
                    <input type="range" class="config-range" min="1" max="5" value="2" id="confDepth">
                    <div class="range-labels">
                        <span>Speed (1)</span>
                        <span id="depthVal" class="highlight-text">Normal (2)</span>
                        <span>Deep (5)</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Creativity Index (Temperature)</label>
                    <input type="range" class="config-range" min="0" max="100" value="70" id="confTemp">
                     <div class="range-labels">
                        <span>Deterministic (0.0)</span>
                        <span id="tempVal" class="highlight-text">0.7</span>
                        <span>Chaotic (1.0)</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Human-in-the-Loop</label>
                    <div class="setting-toggle-label">
                        <input type="checkbox" id="confHumanLoop" checked>
                        <span class="toggle-slider"></span>
                        <span>Require approval for asset generation</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Target Audience / Persona</label>
                    <input type="text" class="g5-input" id="confAudience" placeholder="e.g. Gen Z, Enterprise CTOs, Gamers..." value="General">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="resetConfig">Default</button>
                <button class="btn btn-primary" id="saveConfig">üíæ Save Configuration</button>
            </div>
        </div>
    </div>

    <!-- ============================================
         LOADING OVERLAY
         ============================================ -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner-ring"></div>
            <div class="spinner-text" id="loadingText">Processing...</div>
        </div>
    </div>

    <!-- ============================================
         QUICK ACTIONS BAR
         ============================================ -->
    <div class="quick-actions" id="quickActions">
        <button class="quick-action" id="quickNewChat" title="New Chat (Ctrl+N)">üí¨</button>
        <button class="quick-action" id="quickUpload" title="Upload Asset">üì§</button>
        <button class="quick-action active" id="quickWorkflow" title="5-Min Agency">‚ö°</button>
        <button class="quick-action" id="quickPalette" title="Command Palette (Ctrl+K)">üîç</button>
        <button class="quick-action" id="quickSettings" title="Settings (Ctrl+,)">‚öôÔ∏è</button>
    </div>

    <!-- ============================================
         ACTIVITY INDICATOR
         ============================================ -->
    <div class="activity-indicator hidden" id="activityIndicator">
        <div class="activity-spinner"></div>
        <span class="activity-text" id="activityText">Processing...</span>
    </div>

    <!-- ============================================
         CONTEXT MENU (Hidden by default)
         ============================================ -->
    <div class="context-menu hidden" id="contextMenu">
        <div class="context-menu-item" data-action="copy">
            <span class="menu-icon">üìã</span>
            <span>Copy</span>
            <span class="menu-shortcut">Ctrl+C</span>
        </div>
        <div class="context-menu-item" data-action="paste">
            <span class="menu-icon">üì•</span>
            <span>Paste</span>
            <span class="menu-shortcut">Ctrl+V</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="select-all">
            <span class="menu-icon">‚úì</span>
            <span>Select All</span>
            <span class="menu-shortcut">Ctrl+A</span>
        </div>
        <div class="context-menu-item" data-action="export">
            <span class="menu-icon">üíæ</span>
            <span>Export Chat</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="new-chat">
            <span class="menu-icon">üí¨</span>
            <span>New Chat</span>
            <span class="menu-shortcut">Ctrl+N</span>
        </div>
        <div class="context-menu-item danger" data-action="clear">
            <span class="menu-icon">üóëÔ∏è</span>
            <span>Clear History</span>
        </div>
    </div>

    <!-- ============================================
         NODE DETAILS MODAL
         ============================================ -->
    <!-- ============================================
         NODE DETAILS MODAL
         ============================================ -->
    <div class="modal hidden" id="nodeModal">
        <div class="modal-backdrop"></div>
        <div class="modal-container modal-large">
            <div class="modal-header">
                <h3 id="nodeModalTitle">‚óÜ SN-00 Orchestrator</h3>
                <button class="modal-close" id="closeNodeModal">√ó</button>
            </div>
            <div class="modal-body node-details-body">
                <div class="node-detail-grid">
                    <!-- Node Info -->
                    <div class="node-detail-section">
                        <h4>Node Information</h4>
                        <div class="detail-row">
                            <span class="detail-label">ID</span>
                            <span class="detail-value" id="nodeDetailId">SN-00</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Name</span>
                            <span class="detail-value" id="nodeDetailName">Orchestrator</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Cluster</span>
                            <span class="detail-value" id="nodeDetailCluster">APEX</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status</span>
                            <span class="detail-value status-online" id="nodeDetailStatus">ONLINE</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Uptime</span>
                            <span class="detail-value" id="nodeDetailUptime">99.97%</span>
                        </div>
                    </div>
                    
                    <!-- Node Stats -->
                    <div class="node-detail-section">
                        <h4>Performance Metrics</h4>
                        <div class="detail-row">
                            <span class="detail-label">Avg Response</span>
                            <span class="detail-value">87ms</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Tokens/sec</span>
                            <span class="detail-value">1,247</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Tasks Today</span>
                            <span class="detail-value">156</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Success Rate</span>
                            <span class="detail-value">98.7%</span>
                        </div>
                    </div>
                    
                    <!-- Node Capabilities -->
                    <div class="node-detail-section full-width">
                        <h4>Capabilities</h4>
                        <div class="capability-tags" id="nodeCapabilities">
                            <span class="cap-tag">Orchestration</span>
                            <span class="cap-tag">Routing</span>
                            <span class="cap-tag">Decision Making</span>
                            <span class="cap-tag">Multi-Agent Coordination</span>
                            <span class="cap-tag">Context Management</span>
                        </div>
                    </div>
                    
                    <!-- Node Logs -->
                    <div class="node-detail-section full-width">
                        <h4>Recent Activity</h4>
                        <div class="node-logs" id="nodeLogs">
                            <!-- Logs injected by JS -->
                            <div class="log-entry">[01:42:15] Routed campaign brief to SP-01</div>
                            <div class="log-entry">[01:42:08] Coordinated content pipeline</div>
                            <div class="log-entry">[01:41:55] Optimized context window</div>
                            <div class="log-entry">[01:41:32] Initiated 5-Minute Agency workflow</div>
                        </div>
                    </div>
                </div>
            <!-- NODE CONFIGURATION (Dynamically Toggleable) -->
            <div id="nodeConfigSection" class="node-config-section hidden" style="border-top: 1px solid var(--border-color); padding: 20px; background: rgba(0,0,0,0.2);">
                <h4 style="margin-bottom: 15px; color: var(--accent-primary);">‚öôÔ∏è Node Configuration</h4>
                
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom: 8px; font-size: 0.9em; color: var(--text-secondary);">Operating Mode</label>
                    <select id="nodeModeSelect" class="g5-select" style="width: 100%; padding: 8px; background: var(--bg-surface); border: 1px solid var(--border-color); color: var(--text-primary); border-radius: 4px;">
                        <option value="autonomous">üöÄ Fully Autonomous</option>
                        <option value="human_loop">ü§ù Human-in-the-Loop</option>
                        <option value="strict">üõ°Ô∏è Strict Oversight</option>
                    </select>
                </div>
                
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom: 8px; font-size: 0.9em; color: var(--text-secondary);">Compute Allocation</label>
                    <input type="range" id="nodeComputeSlider" min="10" max="100" value="85" style="width: 100%;">
                    <div style="display:flex; justify-content:space-between; font-size: 0.8em; color: var(--text-secondary); margin-top: 5px;">
                        <span>Low Efficiency</span>
                        <span id="computeValueDisplay">85% TERAFLOPS</span>
                        <span>Max Performance</span>
                    </div>
                </div>
                
                <button class="btn btn-small" id="applyConfigBtn" style="width: 100%; border: 1px solid var(--accent-primary); color: var(--accent-primary); background: transparent;">Save Configuration</button>
            </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="nodeLogsBtn">üìã View Full Logs</button>
                <button class="btn btn-primary" id="nodeActivateBtn">‚ö° Activate Node</button>
            </div>
        </div>
    </div>

    <!-- ============================================
         CHAT HISTORY PANEL (Slide-in)
         ============================================ -->
    <div class="history-panel hidden" id="historyPanel">
        <div class="history-panel-header">
            <h3>üí¨ Chat History</h3>
            <button class="panel-close" id="closeHistoryPanel">√ó</button>
        </div>
        <div class="history-search">
            <input type="text" placeholder="Search conversations..." id="historySearch">
        </div>
        <div class="history-sessions" id="historySessions">
            <div class="history-session active">
                <div class="session-header">
                    <span class="session-icon">üí¨</span>
                    <span class="session-title">Current Session</span>
                    <span class="session-time">Now</span>
                </div>
                <p class="session-preview">52 nodes online and ready...</p>
            </div>
            <div class="history-session">
                <div class="session-header">
                    <span class="session-icon">üìù</span>
                    <span class="session-title">Campaign Strategy</span>
                    <span class="session-time">2h ago</span>
                </div>
                <p class="session-preview">Create a comprehensive marketing...</p>
            </div>
            <div class="history-session">
                <div class="session-header">
                    <span class="session-icon">üîç</span>
                    <span class="session-title">Competitor Analysis</span>
                    <span class="session-time">Yesterday</span>
                </div>
                <p class="session-preview">Analyze the top 5 competitors...</p>
            </div>
            <div class="history-session">
                <div class="session-header">
                    <span class="session-icon">üìä</span>
                    <span class="session-title">Q4 Report Generation</span>
                    <span class="session-time">Jan 26</span>
                </div>
                <p class="session-preview">Generate a comprehensive Q4...</p>
            </div>
            <div class="history-session">
                <div class="session-header">
                    <span class="session-icon">üé¨</span>
                    <span class="session-title">Video Script Draft</span>
                    <span class="session-time">Jan 25</span>
                </div>
                <p class="session-preview">Write a compelling 60-second...</p>
            </div>
        </div>
        <div class="history-panel-footer">
            <button class="btn btn-small btn-secondary" id="clearAllHistory">üóëÔ∏è Clear All</button>
            <button class="btn btn-small btn-primary" id="exportAllHistory">üíæ Export All</button>
        </div>
    </div>

    <!-- ============================================
         SPLIT VIEW TOGGLE
         ============================================ -->
    <div class="split-view-controls hidden" id="splitViewControls">
        <button class="split-btn" data-mode="single" title="Single View">
            <span>‚ñ£</span>
        </button>
        <button class="split-btn" data-mode="vertical" title="Vertical Split">
            <span>‚ó´</span>
        </button>
        <button class="split-btn active" data-mode="horizontal" title="Horizontal Split">
            <span>‚¨ì</span>
        </button>
    </div>

    <!-- ============================================
         THEME SELECTOR (Floating)
         ============================================ -->
    <div class="theme-selector hidden" id="themeSelector">
        <div class="theme-option active" data-theme="obsidian">
            <div class="theme-preview obsidian"></div>
            <span>Obsidian</span>
        </div>
        <div class="theme-option" data-theme="midnight">
            <div class="theme-preview midnight"></div>
            <span>Midnight</span>
        </div>
        <div class="theme-option" data-theme="terminal">
            <div class="theme-preview terminal"></div>
            <span>Terminal</span>
        </div>
    </div>

    <!-- ============================================
         KEYBOARD SHORTCUTS OVERLAY
         ============================================ -->
    <div class="shortcuts-overlay hidden" id="shortcutsOverlay">
        <div class="shortcuts-container">
            <div class="shortcuts-header">
                <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
                <button class="close-shortcuts" id="closeShortcuts">√ó</button>
            </div>
            <div class="shortcuts-grid">
                <div class="shortcut-group">
                    <h4>General</h4>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>K</kbd> Command Palette</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>,</kbd> Settings</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>N</kbd> New Chat</div>
                    <div class="shortcut-item"><kbd>Esc</kbd> Close Modal</div>
                </div>
                <div class="shortcut-group">
                    <h4>Panels</h4>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>`</kbd> Toggle Terminal</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>B</kbd> Toggle Explorer</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>B</kbd> Toggle Agent</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>H</kbd> History Panel</div>
                </div>
                <div class="shortcut-group">
                    <h4>Views</h4>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>1</kbd> Chat View</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>2</kbd> Agents View</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>3</kbd> Workflows View</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>4</kbd> Assets View</div>
                </div>
                <div class="shortcut-group">
                    <h4>Chat</h4>
                    <div class="shortcut-item"><kbd>Enter</kbd> Send Message</div>
                    <div class="shortcut-item"><kbd>Shift</kbd>+<kbd>Enter</kbd> New Line</div>
                    <div class="shortcut-item"><kbd>Ctrl</kbd>+<kbd>L</kbd> Clear Chat</div>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <!-- SCRIPTS -->
    <!-- EXTENSION DETAIL MODAL -->
    <div id="extDetailModal" class="modal-overlay hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content" style="width: 700px; max-width: 90vw;">
            <div class="modal-header">
                <span class="modal-title">PACKAGE DETAILS</span>
                <button class="modal-close" id="closeExtDetail">√ó</button>
            </div>
            <div class="modal-body" style="padding:0;">
                <!-- Header -->
                <div style="background:var(--bg-elevated); padding:30px; display:flex; gap:20px; border-bottom:1px solid #333;">
                    <div id="extDetailIcon" style="font-size:64px;">üì¶</div>
                    <div style="flex:1;">
                        <h2 id="extDetailName" style="margin:0 0 5px 0; font-size:24px; color:var(--text-primary);">Package Name</h2>
                        <div style="display:flex; gap:10px; font-size:12px; color:var(--text-secondary);">
                            <span id="extDetailVersion">v1.0.0</span>
                            <span>‚Ä¢</span>
                            <span id="extDetailAuthor">Google DeepMind</span>
                        </div>
                    </div>
                    <button id="extDetailAction" class="btn btn-primary">INSTALL</button>
                </div>
                
                <!-- Info -->
                <div style="padding:30px; display:flex; flex-direction:column; gap:20px;">
                    <p id="extDetailDesc" style="color:var(--text-secondary); line-height:1.6;">Description goes here.</p>
                    
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                        <div style="background:#111; padding:15px; border-radius:6px;">
                            <h4 style="margin:0 0 10px 0; font-size:12px; color:#666;">PERMISSIONS</h4>
                            <ul id="extDetailPerms" style="margin:0; padding-left:20px; font-size:12px; color:var(--text-primary);">
                                <li>Read File System</li>
                            </ul>
                        </div>
                         <div style="background:#111; padding:15px; border-radius:6px;">
                            <h4 style="margin:0 0 10px 0; font-size:12px; color:#666;">DEPENDENCIES</h4>
                            <ul style="margin:0; padding-left:20px; font-size:12px; color:var(--text-primary);">
                                <li>G5 Core Kernel</li>
                                <li>Node.js Runtime</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AUDIO SYSTEM -->
    <script src="assets/js/audio-system.js?v=REALITY_CHECK_V2"></script>
    <!-- CORE LOGIC (VERSION 6.0) -->
    <script src="assets/js/jury-mode.js?v=REALITY_CHECK_V2"></script>
    <script src="assets/js/g5_api.js?v=REALITY_CHECK_V2"></script>
    <script src="assets/js/g5-os-core.js?v=REALITY_CHECK_V2"></script>
    
    <!-- 3D NAVIGATOR -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- BOOT STRAP LOGIC -->
    <script>
        // Force scroll to top on load
        window.onbeforeunload = function () {
            window.scrollTo(0, 0);
        }
    </script>
    <style>
        /* CONTEXT MENU & SYSTEM POLISH (PHASE 6) */
        .context-menu {
            position: fixed;
            z-index: 10000 !important;
            background: rgba(10, 10, 10, 0.95);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 6px 0;
            width: 220px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            backdrop-filter: blur(12px);
            transform-origin: top left;
            animation: menuFade 0.2s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .context-menu.hidden { display: none; }
        .context-menu-item {
            padding: 10px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            font-size: 13px;
            color: var(--text-secondary);
            font-family: var(--font-primary);
            transition: all 0.2s;
        }
        .context-menu-item:hover {
            background: var(--bg-elevated);
            color: var(--accent-primary);
            padding-left: 20px;
        }
        .context-menu-divider {
            height: 1px;
            background: var(--border-color);
            margin: 6px 0;
            opacity: 0.5;
        }
        .menu-shortcut {
            margin-left: auto;
            font-size: 10px;
            opacity: 0.5;
            font-family: var(--font-mono);
        }
        .context-menu-item.danger:hover {
            color: #ef4444; 
            background: rgba(239, 68, 68, 0.1);
        }
        @keyframes menuFade {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
    <script src="assets/js/neural-3d.js?v=ATOMIC" defer></script>
    
    <script>
    function toggle3DView() {
        if (window.G5OS) {
            window.G5OS.toggle3DView();
            // Optional: Re-init 3D if needed
            if (document.getElementById('agentsView').classList.contains('agents-view-3d')) {
                if (window.initNeural3D) window.initNeural3D();
            }
        }
    }
    </script>
    <!-- SYSTEM CONSTITUTION MODAL (EASTER EGG) -->
    <div id="constitutionModal" class="modal hidden" style="z-index: 10000; background: rgba(0,0,0,0.95); display:none; justify-content:center; align-items:center;">
        <div class="modal-content industrial-modal" style="width: 500px; border: 1px solid var(--accent-primary); box-shadow: 0 0 50px rgba(0, 243, 255, 0.2);">
            <div class="modal-header">
                <h2>üìú G5 SYSTEM CONSTITUTION</h2>
                <button class="close-btn" onclick="document.getElementById('constitutionModal').classList.add('hidden'); document.getElementById('constitutionModal').style.display='none';">&times;</button>
            </div>
            <div class="modal-body" style="padding: 30px;">
                <pre style="color:var(--accent-primary); font-family:'JetBrains Mono'; font-size:12px; line-height:1.5; background:rgba(0,0,0,0.5); padding:20px; border:1px solid rgba(0,243,255,0.1);">
{
  "system_identity": "AGENTICUM_G5",
  "version": "5.0.1_RC",
  "core_directive": "AUTONOMOUS_VALUE_CREATION",
  "ethical_guardrails": {
    "framework": "STRICT_EU_COMPLIANCE",
    "transparency": "radical"
  },
  "infrastructure": "ALPHABET_SOVEREIGN_CLOUD",
  "reasoning_model": "GEMINI_3_PRO_ULTRA",
  "operator_sovereignty": 1.0
}
                </pre>
                <div style="margin-top:20px; font-size:10px; color:var(--text-muted); text-transform:uppercase; letter-spacing:2px; text-align:center;">
                    // The infrastructure is the prophecy //
                </div>
            </div>
        </div>
    </div>

</body>
</html>
